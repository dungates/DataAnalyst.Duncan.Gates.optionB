---
title: "Likeliness to Recommend to a Friend or Colleague"
output:
  rmdformats::robobook:
    self_contained: true # Other options are downcute, material, readthedown, html_clean, html_docco, lockdown, https://github.com/juba/rmdformats
    thumbnails: false
    lightbox: true
    gallery: false
    highlight: kate # Also can do tango
    number_sections: false
    includes:
      after_body: footer.html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, 
                      message = F, 
                      warning = F, 
                      fig.align = 'center', 
                      cache = F, 
                      tidy = T) # No messages, warnings, code echo, align figures center, cache images, and tidy
library(tidyverse) # So you don't have to code in base R
library(hrbrthemes) # For pretty graphing themes
library(readr) # Reading in rds
library(here) # Cross network consistency
library(scales) # For graphing scales
library(ggrepel) # For text output on graphs
library(gt) # For tables
theme_set(theme_minimal())
teaching_colors <- c("#04ABEB", "#040404", "#346475", "#324D56") # Teaching Lab Color Palette - derived from logo
col = grDevices::colorRampPalette(c("#040404", "#04ABEB")) # Color palette maker for blue theme, based on teaching lab color palette
htmltools::tagList(rmarkdown::html_dependency_font_awesome()) # Needed so fa's in footer will show

teaching_lab_df <- read_rds(here("Data/original_df.rds")) # Read original data for column names
```

# Comparing Pre-and Post Pandemic Scores

## EL

```{r}
# Group and then score the data, filter for the pertinent group
grouped_teaching_EL <- teaching_lab_df %>%
  dplyr::filter(str_detect(`Professional training session`, "EL") == T) %>% # Filter for just EL
  dplyr::group_by(`Date for the session`) %>%
  dplyr::mutate(count = length(`Professional training session`),
           score = sum(`How likely are you to recommend this professional learning to a colleague or friend?`)/count,
           prepost = case_when(`Date for the session` >= as.Date("2020-03-23") ~ "Post-Pandemic",
                               `Date for the session` < as.Date("2020-03-23") ~ "Pre-Pandemic")) %>%
  dplyr::group_by(prepost) %>%
  dplyr::mutate(mean_score = mean(score, na.rm = T)) %>%
  dplyr::ungroup() %>%
  dplyr::distinct(`Date for the session`, .keep_all = T) %>%
  dplyr::arrange(score) # Arrange for plotting

## Plot by pre and post pandemic by EL training sessions dates.
ggplot(grouped_teaching_EL, aes(x = `Date for the session`, y = score, fill = 
                                  factor(prepost, levels = c("Pre-Pandemic", "Post-Pandemic")))) +
  geom_col() +
  geom_line(aes(x = `Date for the session`, 
                y = mean_score,
                color = factor(prepost, levels = c("Pre-Pandemic", "Post-Pandemic"))),
            linetype = "dashed") +
  geom_text(aes(label = paste("Mean:", round(mean_score, 1)),
                x = as.Date(ifelse(prepost == "Pre-Pandemic",
                           mean(`Date for the session`[prepost == "Pre-Pandemic"]),
                           mean(`Date for the session`[prepost == "Post-Pandemic"])), origin),
                y = mean_score + 0.5,
                color = factor(prepost, levels = c("Pre-Pandemic", "Post-Pandemic")))) +
  labs(x = "", y = "Average Score per Session", title = "EL Virtual Bootcamp Scores Before and After the Pandemic") +
  scale_fill_manual(values = c("#04ABEB", "#324D56")) +
  scale_color_manual(values = c("#04ABEB", "#324D56")) +
  scale_y_continuous(limits = c(0, 10)) +
  scale_x_date(breaks = scales::breaks_pretty(n = 12)) +
  theme(legend.position = "bottom",
        legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5),
        panel.grid.major = element_blank())
```


## Guidebooks

```{r}
# There's Guidebooks, and GuideBooks so vector for later filter
guidebooks <- c("Guidebooks|GuideBooks")
grouped_teaching_Guidebooks <- teaching_lab_df %>%
  dplyr::filter(str_detect(`Professional training session`, guidebooks) == T) %>% # Filter for just EL
  dplyr::group_by(`Date for the session`) %>%
  dplyr::mutate(count = length(`Professional training session`),
           score = sum(`How likely are you to recommend this professional learning to a colleague or friend?`, na.rm = T)/count,
           prepost = case_when(`Date for the session` >= as.Date("2020-03-23") ~ "Post-Pandemic",
                               `Date for the session` < as.Date("2020-03-23") ~ "Pre-Pandemic")) %>%
  dplyr::group_by(prepost) %>%
  dplyr::mutate(mean_score = mean(score, na.rm = T)) %>%
  dplyr::ungroup() %>%
  dplyr::distinct(`Date for the session`, .keep_all = T) %>%
  dplyr::arrange(score) # Arrange for plotting

# Which ones are NA?

na_dates <- teaching_lab_df %>% dplyr::filter(str_detect(`Professional training session`, guidebooks) == T,
                                  is.na(`How likely are you to recommend this professional learning to a colleague or friend?`)) %>%
    distinct(`Date for the session`)

na_results <- teaching_lab_df %>% filter(na_dates$`Date for the session` == `Date for the session`) # Looks like its entirely as a result of Louisiana State Content Leader Training 

# Simply too many here to plot text
# bar_labels <- dput(grouped_teaching_Guidebooks$`Professional training session`)
# bar_labels <- str_replace_all(bar_labels, "GuideBooks", "Guidebooks")
# bar_labels <- str_replace_all(bar_labels, "Guidebooks ", "Guidebooks\n")

## Plot by pre and post pandemic by EL training sessions dates.
ggplot(grouped_teaching_Guidebooks, aes(x = fct_reorder(as.factor(`Date for the session`), `Date for the session`), y = score, 
                                        fill = factor(prepost, levels = c("Pre-Pandemic", "Post-Pandemic")),
                                    color = factor(prepost, levels = c("Pre-Pandemic", "Post-Pandemic"))
                                    )) +
    geom_col(color = "#324D56") +
    geom_segment(aes(x = "2019-06-05", xend = "2019-12-19", y = -0.2, yend = -0.2),
                 arrow = grid::arrow(length = unit(0.3, "cm"),
                                                       ends = "both"), color = "gray80", size = 1.5) +
    geom_segment(aes(x = "2020-01-05", xend = "2020-12-04", y = -0.2, yend = -0.2),
                 arrow = grid::arrow(length = unit(0.3, "cm"),
                                                       ends = "both"), color = "gray20", size = 1.5) +
    geom_text(aes(x = "2019-09-19", y = -0.4, label = "2019"), color = "gray80") +
    geom_text(aes(x = "2020-03-02", y = -0.4, label = "2020"), color = "gray20") +
    labs(x = "", y = "Average Score per Session", title = "Guidebooks' Scores Before and After the Pandemic",
         caption = "Lafayette School District did not include any scores for several sessions") +
    scale_fill_manual(values = c("#04ABEB", "#324D56")) +
    scale_color_manual(values = c("#04ABEB", "#324D56")) +
    scale_y_continuous(limits = c(-0.4, 10), breaks = scales::breaks_pretty(n = 10)) +
    scale_x_discrete() +
    theme(legend.position = c(0.95,1),
          legend.title = element_blank(),
          plot.title = element_text(hjust = 0.5, family = "Oswald"),
          plot.subtitle = element_text(hjust = 0.5, family = "Oswald"),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          # axis.text.x = element_text(color = "#324D56", family = "Oswald",
          #                            margin = unit(c(0, 0, -0.3, 0), "cm"),
          #                            angle = 90),
          axis.text.x = element_blank(),
          axis.title.y = element_text(family = "Oswald"),
          axis.text.y = element_text(color= "#324D56", family = "Oswald"),
          legend.text = element_text(family = "Oswald"),
          plot.caption = element_text(family = "Oswald", vjust = 25),
          plot.margin = unit(c(0.1,0.1,-0.5,0.1), "cm"))
```


## Illustrative Mathematics (IM)

```{r}
grouped_teaching_IM <- teaching_lab_df %>%
  dplyr::filter(str_detect(`Professional training session`, "IM") == T) %>% # Filter for just EL
  dplyr::group_by(`Date for the session`) %>%
  dplyr::mutate(count = length(`Professional training session`),
           score = sum(`How likely are you to recommend this professional learning to a colleague or friend?`)/count,
           prepost = case_when(`Date for the session` >= as.Date("2020-03-23") ~ "Post-Pandemic",
                               `Date for the session` < as.Date("2020-03-23") ~ "Pre-Pandemic")) %>%
  dplyr::group_by(prepost) %>%
  dplyr::mutate(mean_score = mean(score, na.rm = T)) %>%
  dplyr::ungroup() %>%
  dplyr::distinct(`Date for the session`, .keep_all = T) %>%
  dplyr::arrange(score) # Arrange for plotting

bar_labels <- dput(grouped_teaching_IM$`Professional training session`)
bar_labels <- str_replace_all(bar_labels, "IM", "")
bar_labels <- str_replace_all(bar_labels, "Day", "")
bar_labels <- str_replace_all(bar_labels, "[:digit:]", "")
bar_labels <- str_replace_all(bar_labels, ":", "")
bar_labels <- str_replace_all(bar_labels, ",", "")
bar_labels <- str_replace_all(bar_labels, "(Bootcamp).*", "\\1")
bar_labels <- str_replace_all(bar_labels, "(School Leaders).*", "\\1")
bar_labels <- str_remove(bar_labels, "Springfield EZ")
bar_labels[1] <-"Nebraska Virtual Series"
bar_labels <- str_trim(bar_labels, side = c("both"))
bar_labels <- str_replace_all(bar_labels, " ", "\n")
bar_labels <- str_replace_all(bar_labels, "BootCamp", "Bootcamp")

## Plot by pre and post pandemic by EL training sessions dates.
ggplot(grouped_teaching_IM, aes(x = fct_reorder(as.factor(format(`Date for the session`, '%b %d,\n%Y')), `Date for the session`), y = score, fill = 
                                    factor(prepost, levels = c("Pre-Pandemic", "Post-Pandemic")))) +
    geom_col(color = "#324D56") +
    geom_text(aes(label = bar_labels),
              color = "#324D56",
              position = position_dodge(0.9),
              vjust = -0.25,
              lineheight = 0.8,
              size = 2.5,
              family = "Oswald") +
    labs(x = "", y = "Average Score per Session", title = "Illustrative Mathematic's Scores Before and After the Pandemic") +
    scale_fill_manual(values = c("#04ABEB", "#324D56")) +
    scale_color_manual(values = c("#04ABEB", "#324D56")) +
    scale_y_continuous(limits = c(0, 10), breaks = scales::breaks_pretty(n = 10)) +
  #   geom_segment(aes(x = "July 09, 2019", xend = "December 12, 2020", y = -0.2, yend = -0.2),
  #                arrow = grid::arrow(length = unit(0.3, "cm"),
  #                                                      ends = "both"), color = "#04ABEB", size = 1.5) +
  # geom_segment(aes(x = "January 06, 2020", xend = "October 20, 2020", y = -0.2, yend = -0.2),
  #                arrow = grid::arrow(length = unit(0.3, "cm"),
  #                                                      ends = "both"), color = "#324D56", size = 1.5) +
    theme(legend.position = c(0.86, 0.99),
          legend.box.margin = margin(c(-10,-10,-10,-10)),
          legend.title = element_blank(),
          plot.title = element_text(hjust = 0.5, family = "Oswald"),
          plot.subtitle = element_text(hjust = 0.5, family = "Oswald"),
          panel.grid.major.x = element_blank(),
          panel.grid.minor.y = element_blank(),
          axis.text.x = element_text(color = "#324D56", family = "Oswald",
                                     margin = unit(c(0, 0, -1, 0), "cm"),
                                     vjust = 19),
          # axis.text.x = element_blank(),
          axis.text.y = element_text(color = "#324D56", family = "Oswald"),
          axis.title.y = element_text(family = "Oswald"),
          legend.text = element_text(family = "Oswald"))
# , 
```


## State-level work

```{r}
not_state_level <- c("EL|IM|Guidebooks|GuideBooks") # Define those for which we should filter for later
grouped_teaching_SL <- teaching_lab_df %>%
  dplyr::filter(!str_detect(`Professional training session`, not_state_level) == T) %>% # Filter for just EL
  dplyr::group_by(`Date for the session`) %>%
  dplyr::mutate(count = length(`Professional training session`),
           score = sum(`How likely are you to recommend this professional learning to a colleague or friend?`)/count,
           prepost = case_when(`Date for the session` >= as.Date("2020-03-23") ~ "Post-Pandemic",
                               `Date for the session` < as.Date("2020-03-23") ~ "Pre-Pandemic")) %>%
  dplyr::group_by(prepost) %>%
  dplyr::mutate(mean_score = mean(score, na.rm = T)) %>%
  dplyr::ungroup() %>%
  dplyr::distinct(`Date for the session`, .keep_all = T) %>%
  dplyr::arrange(score) # Arrange for plotting

bar_labels <- grouped_teaching_SL$`Professional training session`
# gsub("((\\S+\\s){2})","\\1\n ", bar_labels) # Doesn't interact well with ggplot
bar_labels <- c("General: Math", "Innovation Network\nFellowship Meeting 1", 
"Innovation Network\nFellowship Meeting\n4 Day 2", "General: Math", 
"Innovation Network\nFellowship Meeting 2", "General: Math", 
"School Leaders:\nLafayette SL-3", "Innovation Network\nFellowship, Meeting 2", 
"Innovation Network\nFellowship Meeting\n4 Day 1", "School Leaders:\nLafayette SL-3", 
"General: Math", "School Leaders:\nLafayette SL-4")


## Plot by pre and post pandemic by EL training sessions dates.
ggplot(grouped_teaching_SL, aes(x = as.factor(`Date for the session`), y = score)) +
  geom_col(fill = "#04ABEB", color = "#324D56") +
  geom_text(aes(label = bar_labels),
            color = "#324D56",
            position = position_dodge(0.9),
            vjust = -0.25,
            size = 2.8,
            family = "Oswald") +
  labs(x = "", y = "Average Score per Session", title = "State Level Scores", subtitle = "Exclusively prior to the pandemic") +
  scale_y_continuous(limits = c(0, 10), breaks = scales::breaks_pretty(n = 10)) +
  scale_x_discrete() +
  theme(legend.position = "none",
        legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5, family = "Oswald"),
        plot.subtitle = element_text(hjust = 0.5, family = "Oswald"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        axis.title.y = element_text(family = "Oswald"),
        axis.text.x = element_text(color = "#324D56", family = "Oswald", 
                                   margin = unit(c(0, 0, -0.2, 0), "cm"),
                                   vjust = 10),
        axis.text.y = element_text(color= "#324D56", family = "Oswald"))
ggsave(here("Images/PresentationStateLevelScores.png"), height = 2481/300, width = 3324/300, dpi = 300) # Triple zoom size with 300 dpi for best res
```


## Boxplot of All Scores

```{r}
# Add columns for pre and post pandemic, as well as different types of training sessions
sorted_teaching_df <- teaching_lab_df %>%
  group_by(`Date for the session`) %>%
  mutate(pro_grouping = case_when(!str_detect(`Professional training session`, not_state_level) == T ~ "State-Level",
                                  str_detect(`Professional training session`, "IM") == T ~ "Illustrative Mathematics",
                                  str_detect(`Professional training session`, guidebooks) == T ~ "Guidebooks",
                                  str_detect(`Professional training session`, "EL") == T ~ "EL"),
         prepost = case_when(`Date for the session` >= as.Date("2020-03-23") ~ "Post-Pandemic",
                               `Date for the session` < as.Date("2020-03-23") ~ "Pre-Pandemic")) %>%
  drop_na(`How likely are you to recommend this professional learning to a colleague or friend?`,
          pro_grouping) %>%
  group_by(pro_grouping, prepost) %>%
  # Means before and after pandemic by type of training session
  mutate(grouped_means = mean(`How likely are you to recommend this professional learning to a colleague or friend?`, na.rm = T)) %>%
  mutate(pro_grouping = forcats::fct_reorder(pro_grouping, -grouped_means)) %>%
  ungroup() %>%
  group_by(prepost) %>%
  # Means of before and after pandemic
  mutate(mean_score = mean(`How likely are you to recommend this professional learning to a colleague or friend?`)) %>%
  ungroup()

# Make the graph aesthetics, theme, and limits
g <- ggplot(sorted_teaching_df, aes(
              x = fct_rev(pro_grouping), 
              y = `How likely are you to recommend this professional learning to a colleague or friend?`, 
              color = pro_grouping
  )) +
  scale_y_continuous(limits = c(0, 10), breaks = scales::breaks_pretty(n = 10)) +
  scale_color_manual(values = col(4)) +
  facet_wrap( ~ factor(prepost, levels = c("Pre-Pandemic", "Post-Pandemic")), ncol = 1) +
  coord_flip() +
  labs(x = "", y = "Likeliness to Recommend to a Friend or Colleague", title = "Comparing Scores Before and After the Pandemic") +
  theme(legend.position = "none",
        legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5, family = "Oswald"),
        plot.subtitle = element_text(hjust = 0.5, family = "Oswald"),
        panel.grid = element_blank(),
        axis.title.y = element_text(family = "Oswald"),
        axis.title.x = element_text(family = "Oswald"),
        axis.text.x = element_text(color = "#324D56", family = "Oswald", 
                                   margin = unit(c(0, 0, -0.2, 0), "cm"),
                                   vjust = 10),
        axis.text.y = element_text(color= "#324D56", family = "Oswald"),
        strip.text = element_text(family = "Oswald", size = 10),
        legend.text = element_text(family = "Oswald"),
        axis.ticks.x = element_line(size = 3, color = "#324D56", linetype = 2),
        axis.ticks.length.x = unit(0.2, "cm"))


# Graph with geoms applied
g + 
  geom_segment(
    aes(x = fct_rev(pro_grouping), xend = fct_rev(pro_grouping),
        y = mean_score, yend = grouped_means),
    show.legend = F,
    size = 0.8
  ) +
  geom_jitter(size = 3, height = 0.15) +
  stat_summary(fun = mean, geom = "point", size = 5) +
  geom_hline(aes(yintercept = mean_score), color = "gray70")

# State Label
state_label <- tibble(prepost = factor(c("Post-Pandemic")), 
                   label = c("No State-Level work has been done since the pandemic began."),
                   pro_grouping = "State-Level", 
                   `How likely are you to recommend this professional learning to a colleague or friend?` = 5)

# Illustrative Mathematics Label
illustrative_label <- tibble(prepost = factor(c("Post-Pandemic")), 
                   label = c("Only 3 Illustrative Mathematics professional learning session reviews\nhave been submitted in the post-pandemic era to yield this average."),
                   pro_grouping = "Illustrative Mathematics", 
                   `How likely are you to recommend this professional learning to a colleague or friend?` = 3.5)
illustrative_arrow <- tibble(prepost = factor(c("Post-Pandemic")),
                             pro_grouping = "Illustrative Mathematics",
                             xend = 2, # Arrow end for x axis, factor based
                             `How likely are you to recommend this professional learning to a colleague or friend?` = 3.5, # Arrow start for x axis
                             yend = 4.6) # Arrow end for y axis

# Guidebooks Label
guidebooks_label <- tibble(prepost = factor(c("Post-Pandemic")), 
                   label = c(glue::glue("Guidebooks scores remain strong, averaging\nonly {round(sorted_teaching_df %>% filter(pro_grouping == 'Guidebooks') %>% distinct(grouped_means) %>% summarise(grouped_means[1]-grouped_means[2]), 2)} less on average.")),
                   pro_grouping = "Illustrative Mathematics", 
                   `How likely are you to recommend this professional learning to a colleague or friend?` = 9)
guidebooks_arrow <- tibble(prepost = factor(c("Post-Pandemic")),
                             pro_grouping = "Illustrative Mathematics",
                             xend = 3,
                             `How likely are you to recommend this professional learning to a colleague or friend?` = 9,
                             yend = 8.45)

# EL Label
el_label <- tibble(prepost = factor(c("Pre-Pandemic")), 
                   label = c(glue::glue("EL had the highest Pre-Pandemic scores,\nwith an average of {round(sorted_teaching_df %>% filter(grouped_means == max(grouped_means)) %>% distinct(grouped_means), 2)}.")),
                   pro_grouping = "EL", 
                   `How likely are you to recommend this professional learning to a colleague or friend?` = 9)
el_arrow <- tibble(prepost = factor(c("Pre-Pandemic")),
                             pro_grouping = "EL",
                             xend = 4,
                             `How likely are you to recommend this professional learning to a colleague or friend?` = 9.5,
                             yend = 9.25)

average_label <- tibble(prepost = factor(c("Pre-Pandemic", "Post-Pandemic")), 
                   label = c(glue::glue("Pre-Pandemic average: {round(sorted_teaching_df %>% distinct(mean_score) %>% filter(mean_score == max(mean_score)), 2)}"),
                             glue::glue("Post-Pandemic average: {round(sorted_teaching_df %>% distinct(mean_score) %>% filter(mean_score == min(mean_score)), 2)}")),
                   pro_grouping = "Illustrative Mathematics", 
                   `How likely are you to recommend this professional learning to a colleague or friend?` = c(9.6, 8.4))
average_arrow <- tibble(prepost = factor(c("Pre-Pandemic", "Post-Pandemic")), 
                   pro_grouping = "Illustrative Mathematics", 
                   `How likely are you to recommend this professional learning to a colleague or friend?` = c(9.15, 7.92),
                   yend = c(8.95, 7.68),
                   xend = c(1.55,1.55))

# Graph with text annotations
(g_text <- 
  g + 
  geom_segment(
    aes(x = fct_rev(pro_grouping), xend = fct_rev(pro_grouping),
        y = mean_score, yend = grouped_means),
    show.legend = F,
    size = 0.8
  ) +
  geom_jitter(size = 3, aes(alpha = prepost), height = 0.15) + # Height changes width here since coord_flip already happened
  scale_alpha_manual(values = c(0.6, 0.2)) + # Manually change the alpha since they need to be set for different n
  stat_summary(fun = mean, geom = "point", size = 5) + # Add mean summary point
  geom_hline(aes(yintercept = mean_score), color = "gray70") +
  geom_text(data = state_label, aes(label = label), family = "Oswald", color = "gray20", size = 3) +
  geom_text(data = illustrative_label, aes(label = label), family = "Oswald", color = "gray20", size = 3, vjust = 1) +
  geom_text(data = guidebooks_label, aes(label = label), family = "Oswald", color = "gray20", size = 3, vjust = -1.1) +
  geom_text(data = el_label, aes(label = label), family = "Oswald", color = "gray20", size = 3, vjust = 2.5) +
  geom_text(data = average_label, aes(label = label), family = "Oswald", color = "gray20", size = 3, vjust = 5.5))

# Graph with arrow annotations
(g_arrow <- 
    g_text +
    geom_curve(data = illustrative_arrow, 
             arrow = arrow(length = unit(0.07, "inch")), 
             aes(xend = xend, yend = yend, x = 2.1),
             size = 0.4,
             color = "gray20",
             curvature = -0.3) +
    geom_curve(data = guidebooks_arrow, 
             arrow = arrow(length = unit(0.07, "inch")), 
             aes(xend = xend, yend = yend, x = 2.6),
             size = 0.4,
             color = "gray20",
             curvature = 0.3) +
    geom_curve(data = el_arrow, 
             arrow = arrow(length = unit(0.07, "inch")), 
             aes(xend = xend, yend = yend, x = 3.7),
             size = 0.4,
             color = "gray20",
             curvature = 0.4) +
    geom_curve(data = average_arrow, 
             arrow = arrow(length = unit(0.07, "inch")), 
             aes(xend = xend, yend = yend, x = c(1.55, 1.55)),
             size = 0.4,
             color = "gray70",
             curvature = 0))
ggsave(here("Images/PresentationPandemicScores.png"), width = 5050.179/300, height = 3007/300, dpi = 300)
```

```{r}
post_responses <- sorted_teaching_df %>% 
  filter(prepost == "Post-Pandemic") %>% 
  select(`How likely are you to recommend this professional learning to a colleague or friend?`, 
         `Why did you choose this rating?`, 
         `Do you have additional comments?`,
         `Professional training session`,
         `Date for the session`) %>% 
  drop_na() %>%
  mutate(Date = format(`Date for the session`, '%b, %d %Y')) %>%
  select(-`Date for the session`) %>%
  dplyr::arrange(`How likely are you to recommend this professional learning to a colleague or friend?`)
post_responses %>%
  gt::gt() %>%
  tab_header(
    title = md("**Reviews in the Post-Pandemic Era**"),
    subtitle = md("Sorted *Worst-Best*")
  ) %>%
  cols_width(
    vars(`How likely are you to recommend this professional learning to a colleague or friend?`) ~ px(105),
         everything() ~ px(250)
  ) %>%
  cols_label(
    `How likely are you to recommend this professional learning to a colleague or friend?` = "Likeliness to Recommend"
  ) %>%
  cols_align(
    align = "center",
    columns = vars(`How likely are you to recommend this professional learning to a colleague or friend?`)
  )
  
```


